language: go
go:
- 1.12.x
install:
- curl -sfL https://install.goreleaser.com/github.com/golangci/golangci-lint.sh |
  sh -s -- -b $(go env GOPATH)/bin v1.20.0
script:
- golangci-lint run --disable-all --enable=vet --enable=ineffassign --enable=goconst
  --tests ./...
- go test -v -race ./...
before_script:
- echo "REPO $TRAVIS_REPO_SLUG TAG ${TRAVIS_TAG}"
deploy:
- provider: script
  script: curl -sL https://git.io/goreleaser | bash
  skip_cleanup: true
  on:
    tags: true
    condition: "$TRAVIS_OS_NAME = linux"
after_deploy:
- git clone https://github.com/sensu/sensu-go-bonsai-asset.git bonsai
- bonsai/generate-sha512sum.sh
- bonsai/github-release-upload.sh github_api_token=$GITHUB_TOKEN repo_slug="$TRAVIS_REPO_SLUG"
  tag="${TRAVIS_TAG}" filename="dist/$(cat dist/sha512_file)"
env:
  global:
  - GO111MODULE=on
  - secure: TDq1oPm4/ldmX6HkZMultpQbIWI2LOUnUtemvHOM4TjPNk1FiI7kAlXApTrNUvNJZbPaKqS3XzyoiEYmJ26Tigp6X0kvKH4CL2axBH4mfCK36rSBXCpwZF8icw2zxrQeBSIoo0WYhbegD9NqNj7l+BA83H+L0PRYxf//WqlkPGWGHg/68AFRr6YWLKW7PqdCYviJq25lAcHoN9wxoA7X88PJjT14a5Wigl/ta0E3i5JNGigdwy6MDLLdKvWVMXWD07XXt1uBOaD7Asuwp+CDhXL/QMVdy/e1enKNtX371+n38HsiPI3+HUxcK7xSJhTYw2Mwuc9sjYVV4hWPC30Ih9LENAmNDdBBEVGq/FDs2Pf98VR403lQxAbBR37yJvbyK6St05nRNHbjs1maI9ZyU4JTgkCVZeI1BDVq2B0ugua4zuAEc3094BJaOYxJHvGvYDzJ0zFZ6IsV301IYA6KpU0fVcMKvqz/NPYensP+zqj/EnwgImosh3PbpZanoFK5qOa/YILnUVMAvUybrl/2FW8TLDZQohleZJuxYsV1eltw0VMtggwtdMfZ0d62EvFZMdcbWnG8eupKsUWvC3GIDUVfPm6IyQHS/D7svXa0qnnkmpNWax+W+6he3gR+bJrFDNBzsGD+uglAHUsM1zs8XZxzFjtD2NllAk3IOa3+fu8=
